<html>
   <head>
   <META HTTP-EQUIV="CONTENT-Type" CONTENT="text/html;CHARSET=utf-8" >
   <title>ActiveSocket HTML Sample</title>
   
   <object id="objSocket" codeBase="http://www.activexperts.com/files/network-component/asocket.dll" height="30" width="200" 
              classid="CLSID:916C28A2-8314-4AA5-9E25-18E5DEFBE2A3" viewastext></object>
   
   <script type="text/javascript">

   var objSocket;
   var nRetr;
   
   function Receive ()
   {
      while ( objSocket.HasData () == -1 )
      {
         textReceive.value = textReceive.value + objSocket.ReceiveString ();
      }

      setTimeout("Receive()",1000)
   }

   function Init ()
   {
      objSocket = new ActiveXObject ( "ActiveXperts.Tcp" );
      
      Receive (); 
   }
   
   function Connect ()
   {
      objSocket.Protocol = objSocket.asPROTOCOL_TELNET;

      objSocket.Connect ( textServer.value, 23 );
         
      textResult.value = "CONNECT: ERROR " + objSocket.LastError + " (" +objSocket.GetErrorDescription ( objSocket.LastError ) +")"; 
   }

   function Disconnect ()
   {
      objSocket.Disconnect ();
      
      textResult.value = "DISCONNECT: ERROR " + objSocket.LastError + " (" + objSocket.GetErrorDescription ( objSocket.LastError ) + ")";
   }
        
   function Send ()
   {
      objSocket.SendString ( textCommand.value );
	          
      textResult.value = "SEND: ERROR " + objSocket.LastError + " (" + objSocket.GetErrorDescription ( objSocket.LastError ) + ")";
   }

   </script>
   </head>
   
   <body onLoad="Init()" >
   <font face="sans-serif" size="2">
   <hr size="1" color="#707070">
   <font size="4">ActiveXperts ActiveSocket HTML Sample</font>
   <br>
   <br>
   <b>Telnet Client Demo.</b>
   <br>
   <hr size="1" color="#707070">
   <br>
   <table border="0" bgcolor="#f0f0f0" ID="Table1">
   <tr>
   </tr>	
   <tr>
      <td valign="top">Telnet Server:</td>
      <td>
         <input size="70" type="text" name="textServer" value="library.uah.edu"><br>
      </td>
      <td>
         <input type="button" onclick="Connect()" value="Connect">
         <input type="button" onclick="Disconnect()" value="Disconnect">
      </td>
   </tr>
   <tr>
      <td valign="top">Command:</td>
      <td>
         <input size="70" type="text" name="textCommand" value="guest"><br>
      </td>
      <td>
         <input type="button" onclick="Send()" value="Send">
      </td>
   </tr>   
   <tr>
      <td valign="top">Received:<br></td>
      <td>
         <textarea rows="6" name="textReceive" cols="54"></textarea>
      </td>
   </tr>
   <tr>
      <td valign="top">Result:</td>
      <td>
         <input size="70" type="text" name="textResult" value=""><br>
      </td>
   </tr>
   </table>
   </body>
</html>